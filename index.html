<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Smart Class Attendance — Ethical Hacking Interface</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      font-family: 'Courier New', monospace;
      background: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 100%);
      color: #e0e0e0;
    }
    .glow {
      box-shadow: 0 0 10px rgba(0, 255, 0, 0.5);
    }
    .glow:hover {
      box-shadow: 0 0 20px rgba(0, 255, 0, 0.8);
    }
    .terminal {
      background: #000;
      border: 1px solid #00ff00;
      color: #00ff00;
      font-family: 'Courier New', monospace;
      padding: 10px;
      overflow: auto;
      max-height: 200px;
    }
    .btn-hack {
      background: linear-gradient(45deg, #00ff00, #008000);
      border: none;
      color: #000;
      font-weight: bold;
    }
    .btn-hack:hover {
      background: linear-gradient(45deg, #008000, #00ff00);
    }
    .input-hack {
      background: #111;
      border: 1px solid #00ff00;
      color: #00ff00;
    }
    .input-hack:focus {
      outline: none;
      box-shadow: 0 0 5px #00ff00;
    }
    .card {
      background: rgba(0, 0, 0, 0.8);
      border: 1px solid #333;
      backdrop-filter: blur(10px);
    }
    .ascii-art {
      font-size: 12px;
      color: #00ff00;
      text-align: center;
      margin-bottom: 20px;
    }
  </style>
</head>
<body class="text-gray-100">
  <div class="max-w-6xl mx-auto p-6">
    <header class="flex items-center justify-between mb-6">
      <h1 class="text-3xl font-bold text-green-400 glow">Smart Class Attendance</h1>
      <nav class="space-x-3">
        <button id="show-login" class="px-3 py-1 rounded-md bg-gray-800 border border-green-400 text-green-400 hover:bg-green-400 hover:text-black glow">Login</button>
        <button id="show-register" class="px-3 py-1 rounded-md bg-gray-800 border border-green-400 text-green-400 hover:bg-green-400 hover:text-black glow">Register</button>
        <button id="show-student" class="px-3 py-1 rounded-md bg-gray-800 border border-green-400 text-green-400 hover:bg-green-400 hover:text-black glow hidden">Student</button>
        <button id="show-teacher" class="px-3 py-1 rounded-md bg-gray-800 border border-green-400 text-green-400 hover:bg-green-400 hover:text-black glow hidden">Teacher</button>
        <button id="logout" class="px-3 py-1 rounded-md bg-red-600 text-white hover:bg-red-700 glow hidden">Logout</button>
      </nav>
    </header>

    <div class="ascii-art">
      <pre>
   _____       __  __       _____ _    _ _    _ _____  
  / ____|     |  \/  |     / ____| |  | | |  | |  __ \ 
 | (___  _   _| \  / |_ __| |    | |  | | |  | | |  | |
  \___ \| | | | |\/| | '_ \ |    | |  | | |  | | |  | |
  ____) | |_| | |  | | | | | |____| |__| | |__| | |__| |
 |_____/ \__, |_|  |_|_| |_|\_____|\____/ \____/ |_____/
         __/ |                                        
        |___/                                         
      </pre>
      <p>Ethical Hacking Attendance System</p>
    </div>

    <!-- Login -->
    <section id="login" class="card p-6 rounded-lg shadow-lg">
      <h2 class="text-xl font-medium mb-3 text-green-400">Login Terminal</h2>
      <p class="text-sm text-gray-400 mb-4">Access granted only to authorized personnel.</p>
      <div class="flex gap-4">
        <div>
          <label class="block text-sm text-green-300">Role</label>
          <select id="role" class="mt-1 p-2 input-hack rounded w-48">
            <option value="student">Student</option>
            <option value="teacher">Teacher</option>
          </select>
        </div>
        <div>
          <label class="block text-sm text-green-300">Username / ID</label>
          <input id="user-id" class="mt-1 p-2 input-hack rounded w-48" placeholder="e.g. Rai - 101" />
        </div>
        <div>
          <label class="block text-sm text-green-300">Password</label>
          <input id="password" type="password" class="mt-1 p-2 input-hack rounded w-48" placeholder="Enter password" />
        </div>
        <div class="self-end">
          <button id="do-login" class="px-4 py-2 btn-hack rounded glow">Initiate Login</button>
        </div>
      </div>
      <div id="login-error" class="mt-2 text-sm text-red-400 hidden">Access Denied. Invalid credentials.</div>
    </section>

    <!-- Register -->
    <section id="register" class="hidden card p-6 rounded-lg shadow-lg">
      <h2 class="text-xl font-medium mb-3 text-green-400">Register Terminal</h2>
      <p class="text-sm text-gray-400 mb-4">Create secure access for attendance tracking.</p>
      <div class="flex gap-4">
        <div>
          <label class="block text-sm text-green-300">Full Name</label>
          <input id="reg-fullname" class="mt-1 p-2 input-hack rounded w-48" placeholder="e.g. John Doe - 104" />
        </div>
        <div>
          <label class="block text-sm text-green-300">Password</label>
          <input id="reg-password" type="password" class="mt-1 p-2 input-hack rounded w-48" placeholder="Enter password" />
        </div>
        <div class="self-end">
          <button id="do-register" class="px-4 py-2 btn-hack rounded glow">Register Access</button>
        </div>
      </div>
      <div id="register-error" class="mt-2 text-sm text-red-400 hidden">Registration Failed. Try again.</div>
      <div id="register-success" class="mt-2 text-sm text-green-400 hidden">Registration Successful! Access granted.</div>
    </section>

    <!-- Student Dashboard -->
    <section id="student" class="hidden mt-6 card p-6 rounded-lg shadow-lg">
      <h2 class="text-xl font-medium mb-3 text-green-400">Student Dashboard</h2>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div class="p-4 border border-green-400 rounded">
          <h3 class="font-semibold mb-2 text-green-300">Mark Attendance</h3>
          <p class="text-sm text-gray-400 mb-3">Your ID will be logged with timestamp.</p>
          <div class="space-y-3">
            <div>
              <label class="block text-sm text-green-300">Selected User</label>
              <div id="selected-user" class="mt-1 p-2 input-hack rounded bg-gray-900">Not logged in</div>
            </div>
            <div>
              <label class="block text-sm text-green-300">Category</label>
              <select id="category" class="mt-1 p-2 input-hack rounded w-full">
                <option>Present</option>
                <option>Late</option>
                <option>Absent</option>
                <option>Excused</option>
              </select>
            </div>
            <div class="flex items-center gap-3">
              <button id="mark" class="px-4 py-2 btn-hack rounded glow">Mark Attendance</button>
              <div id="student-status" class="text-sm text-gray-400">—</div>
            </div>
          </div>
        </div>

        <div class="p-4 border border-green-400 rounded">
          <h3 class="font-semibold mb-2 text-green-300">Recent Entries (Log)</h3>
          <div class="terminal">
            <table class="w-full text-sm">
              <thead class="text-left text-xs text-green-300">
                <tr><th class="py-1">Time</th><th>Student</th><th>Category</th></tr>
              </thead>
              <tbody id="student-entries" class="text-sm text-green-400"></tbody>
            </table>
          </div>
        </div>
      </div>
    </section>

    <!-- Teacher Dashboard -->
    <section id="teacher" class="hidden mt-6 card p-6 rounded-lg shadow-lg">
      <h2 class="text-xl font-medium mb-3 text-green-400">Teacher Dashboard</h2>
      <div class="flex gap-4 mb-4">
        <div>
          <label class="block text-sm text-green-300">Filter by Date</label>
          <input id="filter-date" type="date" class="mt-1 p-2 input-hack rounded" />
        </div>
        <div>
          <label class="block text-sm text-green-300">Filter Category</label>
          <select id="filter-cat" class="mt-1 p-2 input-hack rounded">
            <option value="">All</option>
            <option>Present</option>
            <option>Late</option>
            <option>Absent</option>
            <option>Excused</option>
          </select>
        </div>
        <div class="self-end">
          <button id="apply-filter" class="px-3 py-1 btn-hack rounded glow">Apply Filter</button>
        </div>
      </div>

      <div class="terminal">
        <table class="min-w-full text-sm border-collapse">
          <thead class="bg-gray-800 text-left text-xs text-green-300">
            <tr>
              <th class="p-2">Date</th>
              <th class="p-2">Time</th>
              <th class="p-2">Student</th>
              <th class="p-2">ID</th>
              <th class="p-2">Category</th>
              <th class="p-2">Status</th>
            </tr>
          </thead>
          <tbody id="teacher-table" class="text-green-400"></tbody>
        </table>
      </div>
    </section>

    <footer class="mt-6 text-xs text-gray-500 text-center">This is a static mockup — backend integration for secure attendance logging would be implemented in production.</footer>
  </div>

  <script>
    let token = null;
    let currentUser = null;

    const el = id => document.getElementById(id);

    function updateNav() {
      const isLoggedIn = !!token;
      el('show-login').classList.toggle('hidden', isLoggedIn);
      el('show-register').classList.toggle('hidden', isLoggedIn);
      el('show-student').classList.toggle('hidden', !isLoggedIn || currentUser?.role !== 'student');
      el('show-teacher').classList.toggle('hidden', !isLoggedIn || currentUser?.role !== 'teacher');
      el('logout').classList.toggle('hidden', !isLoggedIn);
    }

    function updateSections() {
      const isLoggedIn = !!token;
      el('login').classList.toggle('hidden', isLoggedIn);
      el('register').classList.toggle('hidden', true);
      el('student').classList.toggle('hidden', !isLoggedIn || currentUser?.role !== 'student');
      el('teacher').classList.toggle('hidden', !isLoggedIn || currentUser?.role !== 'teacher');
    }

    function renderStudentEntries(entries) {
      const tbody = el('student-entries');
      tbody.innerHTML = entries.slice().reverse().slice(0, 6).map(e =>
        `<tr class="border-t border-green-600"><td class="py-1">${e.time}</td><td>${e.student}</td><td>${e.category}</td></tr>`
      ).join('');
    }

    function renderTeacherTable(entries) {
      const tbody = el('teacher-table');
      tbody.innerHTML = entries.map(r =>
        `<tr class="border-t border-green-600"><td class="p-2">${r.date}</td><td class="p-2">${r.time}</td><td class="p-2">${r.student}</td><td class="p-2">${r.id}</td><td class="p-2">${r.category}</td><td class="p-2">${r.status}</td></tr>`
      ).join('');
    }

    // Navigation
    el('show-login').addEventListener('click', () => {
      el('login').classList.remove('hidden');
      el('register').classList.add('hidden');
      el('student').classList.add('hidden');
      el('teacher').classList.add('hidden');
    });
    el('show-register').addEventListener('click', () => {
      el('login').classList.add('hidden');
      el('register').classList.remove('hidden');
      el('student').classList.add('hidden');
      el('teacher').classList.add('hidden');
    });
    el('show-student').addEventListener('click', () => {
      if (token && currentUser?.role === 'student') {
        fetch('/attendance', { headers: { Authorization: `Bearer ${token}` } })
          .then(res => res.json())
          .then(data => renderStudentEntries(data.filter(e => e.student === currentUser.username)));
        el('login').classList.add('hidden');
        el('register').classList.add('hidden');
        el('student').classList.remove('hidden');
        el('teacher').classList.add('hidden');
      }
    });
    el('show-teacher').addEventListener('click', () => {
      if (token && currentUser?.role === 'teacher') {
        fetch('/attendance', { headers: { Authorization: `Bearer ${token}` } })
          .then(res => res.json())
          .then(data => renderTeacherTable(data));
        el('login').classList.add('hidden');
        el('register').classList.add('hidden');
        el('student').classList.add('hidden');
        el('teacher').classList.remove('hidden');
      }
    });
    el('logout').addEventListener('click', () => {
      token = null;
      currentUser = null;
      updateNav();
      updateSections();
    });

    // Mock login
    el('do-login').addEventListener('click', () => {
      const role = el('role').value;
      const userId = el('user-id').value;
      const password = el('password').value;
      if (userId && password) {
        token = 'mock-token';
        currentUser = { role, username: userId };
        el('selected-user').textContent = userId;
        el('login-error').classList.add('hidden');
        updateNav();
        updateSections();
      } else {
        el('login-error').classList.remove('hidden');
      }
    });

    // Mock register
    el('do-register').addEventListener('click', () => {
      const fullname = el('reg-fullname').value;
      const password = el('reg-password').value;
      if (fullname && password) {
        el('register-error').classList.add('hidden');
        el('register-success').classList.remove('hidden');
      } else {
        el('register-error').classList.remove('hidden');
        el('register-success').classList.add('hidden');
      }
    });

    // Mock mark attendance
    el('mark').addEventListener('click', () => {
      const category = el('category').value;
      el('student-status').textContent = `Marked as ${category}`;
    });

    // Mock filter
    el('apply-filter').addEventListener('click', () => {
      // In a real app, filter the data
      console.log('Filter applied');
    });
  </script>
</body>
</html>